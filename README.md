# Hotel Reservation
Mini java project to implement a system that allows a configured level of overbooking.

# Installation
  Prerequisites: `java 1.7+, apache maven 3.5.0+ and docker` 
  
  Steps:
   1. Clone this repo
   2. cd to the installation directory
   3. `mvn package` (This will run JUnit tests and prepare the war file)
   4. `docker build . -f  Dockerfile -t hotelapp` (This will create the docker image)
   5. `docker run -p 5000:8080 -t hotelapp` (This will run the application on port 5000).
   
Quickly test if you can access the application by typing in `http://localhost:5000/hotelapp/` in the browser. You should see a welcome message  `Welcome to the Hotel App!`
   
   
# Database
I have used an embedded relational DB called HSQL for the purpose of this project. Below is the data schema of the tables used:
```
HOTEL_CONFIG (
  id INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 100),
  hotelName varchar(1000) not null,
  address varchar(4000) not null,
  city varchar (200) not null,
  state varchar (2) not null,
  country varchar (100) not null,
  zip varchar(10),
  roomCount INTEGER not null,
  overbookingLevel FLOAT not null,
  customerId varchar (64) not null -- The cust_id is the external hotel id that would be pre-populated when the hotel client is onboarded.
);
```
```
HOTEL_RESERVATION(
 id INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 100),
 hotelId INTEGER NOT NULL,
 guestFirstName varchar(50) not null,
 guestLastName varchar(50) not null,
 guestEmail varchar(200) not null,
 checkIn TIMESTAMP not null,
 checkOut TIMESTAMP not null
);
```
When the application loads up it creates the necessary tables and inserts some test data (via create.sql & insert.sql) for the APIs to function:

HOTEL_CONFIG
```
+-----+----------+-----------+---------------+-------+---------+-------+-----------+------------------+------------+
| ID  | HOTELNAME| ADDRESS   | CITY          | STATE | COUNTRY | ZIP   | ROOMCOUNT | OVERBOOKINGLEVEL | CUSTOMERID |
+-----+----------+-----------+---------------+-------+---------+-------+-----------+------------------+------------+
| 100 | Hilton   | 123 H St. | San Francisco | CA    | USA     | 94105 | 100       | 10.0             | HSF36901   |
| 101 | Hyatt    | 456 Y St. | Los Angeles   | CA    | USA     | 90034 | 250       | 15.0             | YLA10960   |
+-----+----------+-----------+---------------+-------+---------+-------+-----------+------------------+------------+

```
HOTEL_RESERVATION
```
+-----+---------+----------------+---------------+--------------+-------------------------+-------------------------+
| ID  | HOTELID | GUESTFIRSTNAME | GUESTLASTNAME | GUESTEMAIL   | CHECKIN                 | CHECKOUT                |
+-----+---------+----------------+---------------+--------------+-------------------------+-------------------------+
| 100 | 100     | Mike           | Robins        | mr@gmail.com | 2018-04-15 08:54:50.998 | 2018-04-17 08:54:50.998 |
| 101 | 100     | John           | Oliver        | jo@gmail.com | 2018-04-13 08:54:51.001 | 2018-04-17 08:54:51.001 |
| 102 | 100     | Tim            | Martin        | tm@gmail.com | 2018-04-10 08:54:51.002 | 2018-04-15 08:54:51.002 |
| 103 | 100     | Larry          | Page          | lp@gmail.com | 2018-05-15 08:54:51.003 | 2018-05-20 08:54:51.003 |
+-----+---------+----------------+---------------+--------------+-------------------------+-------------------------+
```

# APIs
1. For hotel configuration, where we can set number of rooms and overbooking level.
  ```
  Request: 
     Type: PUT
     
     URL: /v1/config/hotel/{hotel_id}?rooms={room_count}&ovrbkg_level={overbooking_level}
     
     Path variable:
      hotel_id : id of the hotel to be updated (integer)
     
     Query String params: All fields are required. 
       room_count: number of total rooms in the hotel (integer). Must be >=0
       overbooking_level: overbooking tolerance percentage (float). Must be between 0-100

     Content type: application/json   
     
   Responses:
    Code            Description
    ----            -----------
    200             Configuration successful.
    400             Invalid input - invalid param value(s).
    404             Invalid Hotel {hotel_id}.Cannot set configuration.
  ```   
 
2. For making reservations supplying guest name and email, arrival and departure dates.

```
  Request: 
     Type: POST
     
     URL: /v1/reservations/hotel/{hotelId}
     
     Path variable:
      hotel_id : id of the hotel to be updated (integer)
     
     Body: All fields are required.     
       {
        "guestFirstName": {type: string},
        "guestLastName": {type: string},
        "guestEmail": {type: string},
        "checkIn": {type: string, format: YYYY-MM-DD},
        "checkOut": {type: string, format: YYYY-MM-DD}
      }
      
     Content type: application/json   
     
   Responses:
    Code            Description
    ----            -----------
    200             Reservation successful.
    400             Invalid input - invalid param value(s) / Missing one or more body params. 
    404             Invalid Hotel {hotel_id}.Cannot set configuration / Hotel room unavailable for the specified dates.
    422             Invalid date range. 
  ```   
